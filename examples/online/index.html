<!DOCTYPE html>
<html lang="en">
	<head>
	  <meta charset="utf-8">
	  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	  
	  <!-- We will use navigo to make our life easier -->
	  <script src="//unpkg.com/navigo@6"></script>

	  <!-- Load visa-V -->
	  <script src="/visa-V.js"></script>

	  <!-- Unscoped Global CSS -->
	  <style>
	  		h1{
	  			color:green;
	  		}

	  		button{
	  			width: 100%;
	  			height: 100px;
	  			font-size:20px;
	  		}
	  </style>
	</head>
	<body>
		This is a simple online application that demonstrates the usecase of using visa-V in an http server.


		<hr>
		<!-- Create an element container to render the views -->
		<div id="app"></div>

		<script>

			//Get reference to #app element.
			var App = document.getElementById('app');
			
			//A helper fucntion to help us guess the site URL 
			function siteURL(url){
				let protocol 	= location.protocol; 
	            let domain 		= location.hostname; 
	            let port 		= location.port;

	           
	            if(typeof url == 'undefined'){
	            	url = '';
	            }

	            if(port){
	            	return protocol+'//'+domain+':'+port+''+url;
	            }

	            return protocol+'//'+domain+''+url;
	          
			}

		
			var layout = vV( siteURL('/layouts/main.html') ,{
				title: 'Hello World'
			});

			App.append(layout);

			//This event will only fire once
			layout.addEventListener('ready',function(){
				console.log('Layout is ready');
			});

			//varaibles for caching views
			var content_a = null;
			var content_b = null;


			//Load the nav view
			let nav = vV( siteURL('/views/nav.html') );

			//Set the nav view to the layout
			layout.ready().then(()=>{
				layout.setArea('nav',nav);
			});
			
			
			//Initialize Navigo router
			var router = new Navigo();

			router.on('/',()=>{
		
				content_a = content_a || vV( siteURL('/views/sampleContentA.html') );

				layout.ready().then(()=>{
					layout.setArea('body',content_a);
				});
				
			}).on('/a',()=>{

				var content_a = content_a || vV( siteURL('/views/sampleContentA.html') );

				layout.ready().then(()=>{
					layout.setArea('body',content_a);
				});
				

			}).on('/b',()=>{

				var content_b = content_b || vV( siteURL('/views/sampleContentB.html') );

				layout.ready().then(()=>{
					layout.setArea('body',content_b);
				});		

			}).resolve();
		

		</script>
	</body>
</html>